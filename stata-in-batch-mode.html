<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 12 Stata in ‘batch’ mode | A Minimal Book Example</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 12 Stata in ‘batch’ mode | A Minimal Book Example" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Stata in ‘batch’ mode | A Minimal Book Example" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Yihui Xie">


<meta name="date" content="2019-05-27">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="using-stata.html">
<link rel="next" href="additional-statistical-software.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i><b>3</b> Literature</a></li>
<li class="chapter" data-level="4" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>4</b> Methods</a></li>
<li class="chapter" data-level="5" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>5</b> Applications</a><ul>
<li class="chapter" data-level="5.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>5.1</b> Example one</a></li>
<li class="chapter" data-level="5.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>5.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>6</b> Final Words</a></li>
<li class="chapter" data-level="7" data-path="external.html"><a href="external.html"><i class="fa fa-check"></i><b>7</b> External server</a><ul>
<li class="chapter" data-level="7.1" data-path="external.html"><a href="external.html#about-bplim"><i class="fa fa-check"></i><b>7.1</b> <span class="underline">About BPLIM</span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-confidentiality.html"><a href="data-confidentiality.html"><i class="fa fa-check"></i><b>8</b> <span class="underline">Data Confidentiality</span></a></li>
<li class="chapter" data-level="9" data-path="access-to-the-external-server.html"><a href="access-to-the-external-server.html"><i class="fa fa-check"></i><b>9</b> <span class="underline">Access to the External Server</span></a></li>
<li class="chapter" data-level="10" data-path="using-the-shell-in-a-linux-operating-system.html"><a href="using-the-shell-in-a-linux-operating-system.html"><i class="fa fa-check"></i><b>10</b> <span class="underline">Using the ‘shell’ in a Linux Operating System</span></a></li>
<li class="chapter" data-level="11" data-path="using-stata.html"><a href="using-stata.html"><i class="fa fa-check"></i><b>11</b> <span class="underline">Using Stata</span></a></li>
<li class="chapter" data-level="12" data-path="stata-in-batch-mode.html"><a href="stata-in-batch-mode.html"><i class="fa fa-check"></i><b>12</b> <span class="underline">Stata in ‘batch’ mode</span></a></li>
<li class="chapter" data-level="13" data-path="additional-statistical-software.html"><a href="additional-statistical-software.html"><i class="fa fa-check"></i><b>13</b> <span class="underline">Additional Statistical Software</span></a></li>
<li class="chapter" data-level="14" data-path="allowed-outputs.html"><a href="allowed-outputs.html"><i class="fa fa-check"></i><b>14</b> <span class="underline">Allowed outputs</span></a></li>
<li class="chapter" data-level="15" data-path="remove-outputs.html"><a href="remove-outputs.html"><i class="fa fa-check"></i><b>15</b> <span class="underline">Remove outputs</span></a></li>
<li class="chapter" data-level="16" data-path="scientific-support.html"><a href="scientific-support.html"><i class="fa fa-check"></i><b>16</b> <span class="underline">Scientific Support</span></a></li>
<li class="chapter" data-level="17" data-path="appendix-1-basic-shell-commands-on-linux.html"><a href="appendix-1-basic-shell-commands-on-linux.html"><i class="fa fa-check"></i><b>17</b> <span class="underline">Appendix 1 – Basic ‘shell’ Commands on Linux</span></a></li>
<li class="chapter" data-level="18" data-path="appendix-2-using-the-vi-file-editor.html"><a href="appendix-2-using-the-vi-file-editor.html"><i class="fa fa-check"></i><b>18</b> <span class="underline">Appendix 2 – Using the ‘vi’ file editor</span></a></li>
<li class="chapter" data-level="19" data-path="appendix-3-external-servers-password-requirements.html"><a href="appendix-3-external-servers-password-requirements.html"><i class="fa fa-check"></i><b>19</b> <span class="underline">Appendix 3 – External server’s password requirements</span></a></li>
<li class="chapter" data-level="20" data-path="appendix-4-download-install-and-configure-nomachine-client.html"><a href="appendix-4-download-install-and-configure-nomachine-client.html"><i class="fa fa-check"></i><b>20</b> <span class="underline">Appendix 4 – Download, install and configure NoMachine client</span></a></li>
<li class="chapter" data-level="21" data-path="appendix-5-browser-access.html"><a href="appendix-5-browser-access.html"><i class="fa fa-check"></i><b>21</b> <span class="underline">Appendix 5 – Browser access</span></a></li>
<li class="chapter" data-level="22" data-path="appendix-6-frequently-asked-questions.html"><a href="appendix-6-frequently-asked-questions.html"><i class="fa fa-check"></i><b>22</b> <span class="underline">Appendix 6 – Frequently Asked Questions</span></a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Minimal Book Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="stata-in-batch-mode" class="section level1">
<h1><span class="header-section-number">Chapter 12</span> <span class="underline">Stata in ‘batch’ mode</span></h1>
<ol style="list-style-type: decimal">
<li>Start a <em>'<strong>shell</strong>'</em> in Linux and navigate to the directory
of the “do-file” file that you want to run (ex: prog1.do)</li>
</ol>
<p><strong>cd /bplim/projects/I001_jdoe/work_area/</strong> cd
/bplimext/projects/I001_jdoe/work_area/</p>
<ol start="2" style="list-style-type: decimal">
<li>You might find it easier to use ‘Dolphin’ (= File Manager) to move
over your folder structure. In this case, we recommend activating
the ‘shell’ (= ‘Terminal’) associated with ‘Dolphin’</li>
</ol>
<ul>
<li><p>use Dolphin/File Manager</p></li>
<li><p>click ‘F4’ to activate the shell with Dolphin. Benefit: fast
transition within folders and, at the same time, the ability
to run shell commands</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><p>Create an ASCII file named, e.g., ‘batch_prog1’</p></li>
<li><p>Inside the file write just a line with the execution command you
would type in the ‘shell’; e.g.,</p>
<p>/opt/bplimext/stata15/stata-mp do
/bplimext/projects/BPlim_inicial/work_area/prog1.do</p></li>
<li><p>You can use, for example, the command line app ‘vi’ to create the batch file</p></li>
</ol>
<p><img src="media/image14.png" style="width:3.54331in;height:0.81802in" /></p>
<ol start="6" style="list-style-type: decimal">
<li>The batch file can also be created using apps like ‘kwrite’ or Stata
‘do file editor’</li>
</ol>
<p><img src="media/image15.png" style="width:3.54331in;height:1.11324in" /></p>
<p>or</p>
<p><img src="media/image16.png" style="width:3.54331in;height:2.01342in" /></p>
<ol start="7" style="list-style-type: decimal">
<li><p>You may add the extension ‘.txt’ to the name of the batch file, as
sometimes Stata <em>doeditor</em> does not ‘see’ the file ‘batch’, while
it ‘sees’ ‘batch.txt’</p></li>
<li><p>Once the batch file is created one runs the .do file in batch mode
by typing in the ‘Terminal’:</p>
<p>at now –f batch.txt</p></li>
<li><p>Type ‘man at’ to see further option of the command ‘at’; e.g., one
could type</p>
<p>at now + 5 hours –f batch.txt</p></li>
</ol>
<p>or</p>
<pre><code>at now + 4 minutes --f batch\_prog1</code></pre>
<p>to run the Stata program within 5 hours or 4 minutes from now,
respectively. ‘man’ is the help function in Linux</p>
<ol start="10" style="list-style-type: decimal">
<li><p>Type ‘top’ in the shell/Terminal to confirm the program is running</p></li>
<li><p>Under ‘top’ type ‘i’ to hide irrelevant processes (show less output)</p></li>
<li><p>To kill a running process with ‘top’ press ‘k’, for ‘kill’, write
&gt; the process number and then type ‘9’. The process number is
&gt; identified in the first column as PID</p></li>
<li><p>To get out of the top, type ‘q’</p></li>
<li><p>Useful features of the command ‘at’:</p></li>
</ol>
<ul>
<li><p>‘atq’: use it to see programs in the batch queue (an ‘=’ sign
indicates the program is running; an ‘a’ indicates it is in
the queue and we see the time when it will be executed)</p></li>
<li><p>‘atrm #’: remove a batch from the batch queue</p></li>
<li><p>one can see how the batch is running by typing</p>
<p>‘tail –f logcrc_may21.log’</p></li>
</ul>
<p>It allows you to see an updated version of the last lines of the log;
<em>i.e.</em>, it updates each time the log is changed by Stata. A key
advantage of tail is that it does not interfere with the log file,
namely it does not write over it.</p>
<ol start="15" style="list-style-type: decimal">
<li>Another way to run a program in the background is by using the
command ‘screen’</li>
</ol>
<ul>
<li><p>‘screen’ is useful when one wants to run Stata in interactive
mode and still guarantee that if the network connection goes
down one does not lose the session. We can simply kill the
‘NoMachine’ session and recover it later by typing ‘screen
–r’</p></li>
<li><p>We can run several instances of screen. If this is the case,
after opening a new NoMachine session we need to type in the
Terminal shell ‘screen –d’ to identify the running background
sessions. We can retrieve a particular session by knowing the
‘pid’ number and typing ‘screen –r 34176’</p></li>
</ul>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="using-stata.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="additional-statistical-software.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/06-external.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
